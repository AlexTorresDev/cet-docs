---
import type { MarkdownHeading } from "astro";
import type { CollectionEntry } from "astro:content";
import BaseHead from "@components/BaseHead.astro";
import Header from "@components/Header/Header.astro";
import PageContent from "@components/PageContent/PageContent.astro";
import LeftSidebar from "@components/LeftSidebar/LeftSidebar.astro";
import RightSidebar from "@components/RightSidebar/RightSidebar.astro";
import Footer from "@components/Footer/Footer.astro";
import { GITHUB_EDIT_URL, SITE } from "../consts";

type Props = CollectionEntry<"docs">["data"] & {
  headings: MarkdownHeading[];
  is404?: boolean;
  isDocs?: boolean;
};

const { headings, is404 = false, isDocs = false, ...data } = Astro.props;
const canonicalURL = new URL(Astro.url.pathname, Astro.site);
const currentPage = Astro.url.pathname;
const currentFile = `src/content/docs${currentPage.replace(/\/?docs/, "")}.md`;
const githubEditUrl = `${GITHUB_EDIT_URL}/${currentFile}`;
---

<!DOCTYPE html>
<html dir={data.dir} lang={data.lang} data-theme="halloween">
  <head>
    <BaseHead
      title={data.title}
      description={data.description}
      image={data.image?.src}
    />
  </head>
  <body>
    <div class:list={["bg-base-100 drawer", { "drawer-mobile": isDocs }]}>
      <input id="my-drawer" type="checkbox" class="drawer-toggle" />

      <main class="drawer-content">
        <Header currentPage={currentPage} isDocs={isDocs} />

        <div class="flex gap-6 p-6">
          <PageContent
            title={data.title}
            headings={headings}
            githubEditUrl={githubEditUrl}
            isDocs={isDocs}
          >
            <slot />
          </PageContent>

          {
            isDocs && (
              <RightSidebar headings={headings} githubEditUrl={githubEditUrl} />
            )
          }
        </div>

        <Footer />
      </main>

      <aside class="drawer-side">
        <label for="my-drawer" class="drawer-overlay"></label>
        <LeftSidebar currentPage={currentPage} />
      </aside>
    </div>
  </body>
</html>
