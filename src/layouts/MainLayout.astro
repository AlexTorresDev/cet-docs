---
import type { MarkdownHeading } from "astro";
import type { CollectionEntry } from "astro:content";
import PageContent from "../components/PageContent/PageContent.astro";
import LeftSidebar from "../components/LeftSidebar/LeftSidebar.astro";
import RightSidebar from "../components/RightSidebar/RightSidebar.astro";
import { GITHUB_EDIT_URL, SITE } from "../consts";
import BaseLayout from "./BaseLayout.astro";

type Props = CollectionEntry<"docs">["data"] & {
	headings: MarkdownHeading[];
};

const { headings, ...data } = Astro.props;
const canonicalURL = new URL(Astro.url.pathname, Astro.site);
const currentPage = Astro.url.pathname;
const currentFile = `src/content/docs${currentPage.replace(/\/$/, "")}.md`;
const githubEditUrl = `${GITHUB_EDIT_URL}/${currentFile}`;
---

<BaseLayout
	dir={data.dir}
	lang={data.lang}
	ogLocale={data.ogLocale}
	title={data.title}
	description={data.description}
	image={data.image}
>
	<aside class="hidden md:flex fixed h-screen md:sticky top-0 p-0" title="Site Navigation">
		<LeftSidebar currentPage={currentPage} />
	</aside>
	<div class="flex flex-col h-full">
		<PageContent
			title={data.title}
			headings={headings}
			githubEditUrl={githubEditUrl}
		>
			<slot />
		</PageContent>
	</div>
	<aside class="hidden md:flex fixed h-screen md:sticky top-0 p-0" title="Table of Contents">
		<RightSidebar headings={headings} githubEditUrl={githubEditUrl} />
	</aside>
</BaseLayout>
